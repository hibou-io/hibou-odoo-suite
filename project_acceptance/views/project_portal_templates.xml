<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_my_task_inherit" inherit_id="project.portal_my_task">
        <xpath expr="//div[@class='mt32']" position="before">

            <div role="dialog" class="modal fade" id="modalaccept">
                <div class="modal-dialog">
                    <form id="project_accept_modal" method="POST" t-att-action="task.get_portal_url(suffix='/accept')" enctype="multipart/form-data" class="modal-content">
                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                        <header class="modal-header">
                            <h4 class="modal-title">Validate Task</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">×</button>
                        </header>

                        <main class="modal-body" id="accept-dialog">
                            <p>
                                <span>I agree to the task description:</span>
                                <ul>
                                    <li><span>Accepted on the behalf of:</span> <b t-field="task.partner_id.commercial_partner_id"/></li>
                                </ul>
                            </p>
                        </main>

                        <footer class="modal-footer">
                            <button type="submit" t-att-id="task.id" class="btn btn-primary"><i class="fa fa-check"></i> Accept</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        </footer>

                    </form>
                </div>
            </div>

            <div role="dialog" class="modal fade" id="modaldecline">
                <div class="modal-dialog">
                    <form id="project_decline_modal" method="POST" t-att-action="task.get_portal_url(suffix='/decline')" enctype="multipart/form-data" class="modal-content">
                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                        <header class="modal-header">
                            <h4 class="modal-title">Validate Task</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">×</button>
                        </header>

                        <main class="modal-body" id="sign-dialog">
                            <p>
                                <span>I agree to the task description:</span>
                                <ul>
                                    <li><span>Declined on the behalf of:</span> <b t-field="task.partner_id.commercial_partner_id"/></li>
                                </ul>
                            </p>
                        </main>

                        <footer class="modal-footer">
                            <button type="submit" t-att-id="task.id" class="btn btn-primary"><i class="fa fa-check"></i> Decline</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        </footer>
                    </form>
                </div>
            </div>

            <div t-if="task.stage_id.requires_acceptance">
                <div class="row justify-content-center text-center d-print-none pt-1 pb-4">
                    <div class="col-sm-auto mt8">
                            <button class="btn btn-primary" data-toggle="modal" data-target="#modalaccept" t-attf-href="#" style="color: #ffffff"><i class="fa fa-check"/> Accept</button>
                    </div>
                    <div class="col-sm-auto mt8">
                            <button class="btn btn-danger" data-toggle="modal" data-target="#modaldecline" t-attf-href="#" style="color: #ffffff"> <i class="fa fa-stop-circle"/> Decline</button>
                    </div>
                    <div class="col-sm-auto mt8">
                        <a role="button" class="btn btn-warning" href="#discussion" style="color: #ffffff"><i class="fa fa-comment"/> Feedback</a>
                    </div>
                </div>
            </div>

        </xpath>
    </template>

</odoo>